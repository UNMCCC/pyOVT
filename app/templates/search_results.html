{% if results %}
<div class="results-count">
    {% set count = results|length %}
    {% if count == 1 %}
        1 result found
    {% elif count == limit %}
        {{ count }} results found (showing maximum of {{ limit }})
    {% else %}
        {{ count }} results found
    {% endif %}

    {% if search_mode %}
        <span class="search-mode-indicator search-mode-{{ search_mode }}">
            {% if search_mode == 'semantic' %}
                üîç Semantic Search
            {% elif search_mode == 'fuzzy' %}
                ~ Fuzzy Search
            {% elif search_mode == 'exact' %}
                = Exact Search
            {% endif %}
        </span>
    {% endif %}
</div>
{% for concept in results %}
<a href="/concept/{{ concept.concept_id }}" class="concept-card">
    <div class="concept-header">
        <span class="concept-name">{{ concept.concept_name }}</span>
        <span class="concept-id">ID: {{ concept.concept_id }}</span>
    </div>

    <div class="concept-meta">
        {# Show concept code in metadata section if it exists #}
        {% if concept.concept_code %}
        <span class="badge badge-code-display">
            {{ concept.concept_code }}

            {# Add match indicator if code matches query #}
            {% if query %}
                {% set q_lower = query.lower() %}
                {% set code_lower = concept.concept_code.lower() %}

                {% if q_lower == code_lower %}
                    <span class="match-indicator exact-code">‚úì Exact</span>
                {% elif code_lower.startswith(q_lower) or q_lower in code_lower %}
                    <span class="match-indicator code">‚úì</span>
                {% endif %}
            {% endif %}
        </span>
        {% endif %}

        <span class="badge">{{ concept.vocabulary_id }}</span>
        <span class="badge">{{ concept.domain_id }}</span>
        <span class="badge">{{ concept.concept_class_id }}</span>
        {% if concept.standard_concept == 'S' %}
        <span class="badge" style="background: rgba(16, 185, 129, 0.2); color: #10b981;">Standard</span>
        {% endif %}
    </div>
</a>
{% endfor %}
{% else %}
<div style="text-align: center; color: var(--secondary-color); padding: 2rem;">
    No results found.
</div>
{% endif %}